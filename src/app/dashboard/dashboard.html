<header class="topbar">
  <div class="brand">
    <div class="logo">ğŸ“¡</div>
    <div>
      <div class="title">FarmAgri</div>
      <div class="subtitle">Raspberry Pi Sensor Monitor</div>
    </div>
  </div>
  <div class="status">
    <div class="wifi" [class.off]="!connected()">â—</div>
    <div>{{ connected() ? 'Connected' : 'Disconnected' }}</div>
    <div class="last">Last update: {{ lastUpdate() | date:'shortTime' }}</div>
  </div>
</header>

<main class="container">
  <!-- KPI Cards -->
  <section class="kpis">
    <div class="card">
      <div class="icon">ğŸŒ¡ï¸</div>
      <div class="label">Temperature</div>
      <div class="value">{{ temperature() | number:'1.1-1' }} Â°C</div>
      <div class="minmax">
        Min: {{ tempStats().min | number:'1.1-1' }} Â°C | Max: {{ tempStats().max | number:'1.1-1' }} Â°C
      </div>
    </div>
    <div class="card">
      <div class="icon">ğŸ’§</div>
      <div class="label">Humidity</div>
      <div class="value">{{ humidity() | number:'1.1-1' }} %</div>
      <div class="minmax">
        Min: {{ humStats().min | number:'1.1-1' }} % | Max: {{ humStats().max | number:'1.1-1' }} %
      </div>
    </div>
    <div class="card">
      <div class="icon">ğŸ”¥</div>
      <div class="label">Gas</div>
      <div class="value">{{ gas() ? 'DÃ©tectÃ©' : 'Non dÃ©tectÃ©' }}</div>
      <div class="minmax">
        Statut: {{ gas() === 1 ? 'ON' : 'OFF' }}
      </div>
    </div>
    <div class="card">
      <div class="icon">ğŸ’¡</div>
      <div class="label">Light</div>
      <div class="value">{{ light() ? 'AllumÃ©e' : 'Ã‰teinte' }}</div>
      <div class="minmax">
        Statut: {{ light() === 1 ? 'ON' : 'OFF' }}
      </div>
    </div>
    <div class="card">
      <div class="icon">ğŸ’§</div>
      <div class="label">Water</div>
      <div class="value">{{ water() ? 'DÃ©tectÃ©e' : 'Non dÃ©tectÃ©e' }}</div>
      <div class="minmax">
        Statut: {{ water() === 1 ? 'ON' : 'OFF' }}
      </div>
    </div>
  </section>

  <!-- Graphs -->
  <section class="charts">
    <div class="chart-card">
      <div class="chart-header">
        <h3>Temperature History</h3>
        <small>Last 20 readings</small>
      </div>
      <div class="chart-container">
        <canvas baseChart
                #tempChart
                [data]="tempChartData()"
                [options]="tempChartOptions()"
                [type]="'line'">
        </canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>Humidity History</h3>
        <small>Last 20 readings</small>
      </div>
      <div class="chart-container">
        <canvas baseChart
                #humChart
                [data]="humChartData()"
                [options]="humChartOptions()"
                [type]="'line'">
        </canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>Gas Detection History</h3>
        <small>Last 20 readings</small>
      </div>
      <div class="chart-container">
        <canvas baseChart
                #gasChart
                [data]="gasChartData()"
                [options]="gasChartOptions()"
                [type]="'line'">
        </canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>Light Status History</h3>
        <small>Last 20 readings</small>
      </div>
      <div class="chart-container">
        <canvas baseChart
                #lightChart
                [data]="lightChartData()"
                [options]="lightChartOptions()"
                [type]="'line'">
        </canvas>
      </div>
    </div>

    <div class="chart-card">
      <div class="chart-header">
        <h3>Water Detection History</h3>
        <small>Last 20 readings</small>
      </div>
      <div class="chart-container">
        <canvas baseChart
                #waterChart
                [data]="waterChartData()"
                [options]="waterChartOptions()"
                [type]="'line'">
        </canvas>
      </div>
    </div>
  </section>

  <!-- Export & Daily Summary Buttons -->
 <section class="export-summary">
    <div class="export-card">
      <h4>Export Sensor Data</h4>
      <p>Export the last 20 readings in JSON format, point by point.</p>
      <button (click)="exportData()" class="btn-export">Export JSON</button>
    </div>

    <div class="summary-card">
      <h4>Daily Summary</h4>
      <p>Generate a daily summary file (.txt) with averages, min, max.</p>
      <button (click)="generateDailySummary()" class="btn-summary">Generate TXT</button>
    </div>
  </section>
</main>
